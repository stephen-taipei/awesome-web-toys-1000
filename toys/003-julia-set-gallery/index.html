<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>#003 Julia Set Gallery èŒ±è‰äºé›†åˆç•«å»Š | Awesome Web Toys</title>
    <meta name="description" content="äº’å‹•å¼èŒ±è‰äºé›†åˆç•«å»Š - æ‹–æ›³æ§åˆ¶ c åƒæ•¸ï¼Œå³æ™‚é è¦½ç„¡é™è®ŠåŒ–çš„åˆ†å½¢ä¹‹ç¾">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- ä¸»ç•«å¸ƒ -->
    <canvas id="canvas"></canvas>

    <!-- c åƒæ•¸æ§åˆ¶å€ (å°å‹æ›¼å¾·åšé è¦½) -->
    <div id="c-picker">
        <canvas id="mandelbrot-preview"></canvas>
        <div class="c-marker" id="c-marker"></div>
        <div class="c-value">
            <span>c = </span>
            <strong id="c-display">-0.7 + 0.27i</strong>
        </div>
    </div>

    <!-- æ§åˆ¶é¢æ¿ -->
    <div id="controls">
        <h1>ğŸ¨ èŒ±è‰äºé›†åˆ Julia Set</h1>
        <div class="info">
            <p><span class="key">å·¦å´é¢æ¿</span> æ‹–æ›³é¸æ“‡ c å€¼</p>
            <p><span class="key">ä¸»ç•«å¸ƒæ‹–æ›³</span> å¹³ç§»è¦–è§’</p>
            <p><span class="key">æ»¾è¼ª</span> ç¸®æ”¾æ¢ç´¢</p>
            <p><span class="key">R</span> é‡ç½®è¦–è§’</p>
        </div>
        <div class="stats">
            <div class="stat-row">
                <span>ç¸®æ”¾:</span>
                <strong id="zoom-display">1x</strong>
            </div>
        </div>
    </div>

    <!-- é è¨­ç•«å»Š -->
    <div id="gallery">
        <label>ç¶“å…¸åœ–æ¡ˆ</label>
        <div class="gallery-items">
            <button class="gallery-item active" data-cr="-0.7" data-ci="0.27015" title="èºæ—‹">
                <span class="preview" style="background: linear-gradient(135deg, #1a1a2e, #4a90a4);"></span>
            </button>
            <button class="gallery-item" data-cr="-0.8" data-ci="0.156" title="æµ·é¦¬è°·">
                <span class="preview" style="background: linear-gradient(135deg, #2d1b4e, #8b5cf6);"></span>
            </button>
            <button class="gallery-item" data-cr="-0.4" data-ci="0.6" title="å…”å­">
                <span class="preview" style="background: linear-gradient(135deg, #1e3a5f, #3b82f6);"></span>
            </button>
            <button class="gallery-item" data-cr="0.285" data-ci="0.01" title="æ˜Ÿå¡µ">
                <span class="preview" style="background: linear-gradient(135deg, #1a1a1a, #fbbf24);"></span>
            </button>
            <button class="gallery-item" data-cr="-0.835" data-ci="-0.2321" title="é–ƒé›»">
                <span class="preview" style="background: linear-gradient(135deg, #0f172a, #06b6d4);"></span>
            </button>
            <button class="gallery-item" data-cr="-0.70176" data-ci="-0.3842" title="é›ªèŠ±">
                <span class="preview" style="background: linear-gradient(135deg, #1e1e2e, #a78bfa);"></span>
            </button>
            <button class="gallery-item" data-cr="0.355" data-ci="0.355" title="å°ç¨±">
                <span class="preview" style="background: linear-gradient(135deg, #1f2937, #10b981);"></span>
            </button>
            <button class="gallery-item" data-cr="-0.54" data-ci="0.54" title="æ¼©æ¸¦">
                <span class="preview" style="background: linear-gradient(135deg, #27272a, #f472b6);"></span>
            </button>
        </div>
    </div>

    <!-- é…è‰²æ–¹æ¡ˆ -->
    <div id="palette-selector">
        <button class="palette-btn active" data-palette="0" title="ç¶“å…¸">
            <span class="palette-preview classic"></span>
        </button>
        <button class="palette-btn" data-palette="1" title="ç«ç„°">
            <span class="palette-preview fire"></span>
        </button>
        <button class="palette-btn" data-palette="2" title="æµ·æ´‹">
            <span class="palette-preview ocean"></span>
        </button>
        <button class="palette-btn" data-palette="3" title="éœ“è™¹">
            <span class="palette-preview neon"></span>
        </button>
    </div>

    <!-- Vertex Shader -->
    <script id="vertex-shader" type="x-shader/x-vertex">
        attribute vec2 a_position;
        void main() {
            gl_Position = vec4(a_position, 0.0, 1.0);
        }
    </script>

    <!-- Fragment Shader - Julia Set -->
    <script id="fragment-shader" type="x-shader/x-fragment">
        precision highp float;

        uniform vec2 u_resolution;
        uniform vec2 u_center;
        uniform float u_zoom;
        uniform vec2 u_c;
        uniform int u_maxIter;
        uniform int u_palette;

        // é…è‰²å‡½æ•¸
        vec3 palette(float t, int paletteType) {
            if (paletteType == 0) {
                // ç¶“å…¸è—é»ƒ
                return vec3(
                    9.0 * (1.0 - t) * t * t * t,
                    15.0 * (1.0 - t) * (1.0 - t) * t * t,
                    8.5 * (1.0 - t) * (1.0 - t) * (1.0 - t) * t
                );
            } else if (paletteType == 1) {
                // ç«ç„°
                return vec3(
                    min(1.0, t * 3.0),
                    max(0.0, min(1.0, (t - 0.33) * 3.0)),
                    max(0.0, min(1.0, (t - 0.66) * 3.0))
                );
            } else if (paletteType == 2) {
                // æµ·æ´‹
                return vec3(
                    t * t * 0.4,
                    t * 0.7,
                    0.4 + t * 0.6
                );
            } else {
                // éœ“è™¹
                float h = t * 6.0;
                float x = 1.0 - abs(mod(h, 2.0) - 1.0);
                if (h < 1.0) return vec3(1.0, x, 0.0);
                if (h < 2.0) return vec3(x, 1.0, 0.0);
                if (h < 3.0) return vec3(0.0, 1.0, x);
                if (h < 4.0) return vec3(0.0, x, 1.0);
                if (h < 5.0) return vec3(x, 0.0, 1.0);
                return vec3(1.0, 0.0, x);
            }
        }

        void main() {
            // è¨ˆç®—è¤‡æ•¸åº§æ¨™
            vec2 uv = gl_FragCoord.xy / u_resolution;
            float aspect = u_resolution.x / u_resolution.y;

            float scale = 3.0 / u_zoom;
            vec2 z = vec2(
                (uv.x - 0.5) * scale * aspect + u_center.x,
                (uv.y - 0.5) * scale + u_center.y
            );

            // Julia é›†åˆè¿­ä»£
            int iter = 0;
            float zx = z.x;
            float zy = z.y;

            for (int i = 0; i < 500; i++) {
                if (i >= u_maxIter) break;

                float zx2 = zx * zx;
                float zy2 = zy * zy;

                if (zx2 + zy2 > 4.0) break;

                float newZx = zx2 - zy2 + u_c.x;
                zy = 2.0 * zx * zy + u_c.y;
                zx = newZx;

                iter++;
            }

            // è‘—è‰²
            if (iter == u_maxIter) {
                gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
            } else {
                // å¹³æ»‘è‘—è‰²
                float smoothIter = float(iter) + 1.0 - log2(log2(zx * zx + zy * zy));
                float t = mod(smoothIter / 50.0, 1.0);
                vec3 color = palette(t, u_palette);
                gl_FragColor = vec4(color, 1.0);
            }
        }
    </script>

    <!-- Fragment Shader - Mandelbrot Preview -->
    <script id="mandelbrot-shader" type="x-shader/x-fragment">
        precision highp float;

        uniform vec2 u_resolution;

        void main() {
            vec2 uv = gl_FragCoord.xy / u_resolution;

            // æ›¼å¾·åšé›†åˆç¯„åœï¼šå¯¦éƒ¨ -2.5 åˆ° 1ï¼Œè™›éƒ¨ -1.2 åˆ° 1.2
            float cx = uv.x * 3.5 - 2.5;
            float cy = uv.y * 2.4 - 1.2;

            float zx = 0.0;
            float zy = 0.0;
            int iter = 0;
            const int maxIter = 100;

            for (int i = 0; i < maxIter; i++) {
                float zx2 = zx * zx;
                float zy2 = zy * zy;

                if (zx2 + zy2 > 4.0) break;

                zy = 2.0 * zx * zy + cy;
                zx = zx2 - zy2 + cx;
                iter++;
            }

            if (iter == maxIter) {
                gl_FragColor = vec4(0.15, 0.15, 0.2, 1.0);
            } else {
                float t = float(iter) / float(maxIter);
                gl_FragColor = vec4(
                    0.1 + t * 0.3,
                    0.1 + t * 0.4,
                    0.2 + t * 0.5,
                    1.0
                );
            }
        }
    </script>

    <script src="script.js"></script>
</body>
</html>
